---
title: "Test_bseqsc"
author: "Zhang Yiming"
date: "6/25/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{R}
library(csSAM)
library(bseqsc)
library(ggplot2)

rm(list=ls())
```


```{r}
csfit <- readRDS("/mnt/raid62/Lung_cancer_10x/packages/csfit.rds")

csTopTable(csfit, merge=TRUE, nodups = T)
```

```{r}
load("/mnt/raid62/Lung_cancer_10x/05_tmod_stage/SYSU/seven_fit_output.RData")
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

           A4GALT     AAAS     AACS   AADAC   AADACP1
A4GALT   1.000000 0.062518 -0.31660 0.10366 -0.438183
AAAS     0.062518 1.000000  0.78718 0.80506  0.289396
AACS    -0.316604 0.787176  1.00000 0.73056  0.485447
AADAC    0.103661 0.805056  0.73056 1.00000  0.179797
AADACP1 -0.438183 0.289396  0.48545 0.17980  1.000000
AADAT   -0.290085 0.491586  0.62438 0.63543  0.045895

```{r cars}
obj <- readRDS("/mnt/raid62/Lung_cancer_10x/02_figures_each_cell/Basal_SCC/Basal.rds")
```


```{R}
make_line_plot <- function(object, x, y) {
    mat = as.matrix(t(object@scale.data[c(x, y), ]))
    
    p <- eval(
        parse(
            text = paste("ggplot(data = mat, aes(x=",  x,", y=", y, "))")
        )
    )
    
    p = p + geom_point()
    
    return(p)
}
```

AADAC - AAAS -> 0.80506
```{R}
make_line_plot(obj, x="AADAC", y="AAAS")
```

A4GALT - AAAS -> 0.062518
```{R}
make_line_plot(obj, x="A4GALT", y="AAAS")
```

AADAC - AACS -> 0.73056
```{R}
make_line_plot(obj, x="AADAC", y="AACS")
```


AADACP1 - AADAT -> 0.045895
```{R}
make_line_plot(obj, x="AADACP1", y="AADAT")
```


AADACP1 - AACS -> 0.48545
```{R}
make_line_plot(obj, x="AADACP1", y="AACS")
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
